{"noir_version":"1.0.0-beta.9+6abff2f16e1c1314ba30708d1cf032a536de3d19","hash":"13015017269101726692","abi":{"parameters":[{"name":"secret","type":{"kind":"field"},"visibility":"private"},{"name":"token_id","type":{"kind":"field"},"visibility":"private"},{"name":"owner_pub_key","type":{"kind":"field"},"visibility":"private"},{"name":"metadata_hash_private","type":{"kind":"field"},"visibility":"private"},{"name":"merkle_proof","type":{"kind":"array","length":20,"type":{"kind":"field"}},"visibility":"private"},{"name":"leaf_index","type":{"kind":"field"},"visibility":"private"},{"name":"root","type":{"kind":"field"},"visibility":"public"},{"name":"nullifier","type":{"kind":"field"},"visibility":"public"},{"name":"metadata_hash","type":{"kind":"field"},"visibility":"public"}],"return_type":null,"error_types":{"355247035133823234":{"error_kind":"string","string":"Metadata hash mismatch"},"12504151944586406243":{"error_kind":"string","string":"Invalid Merkle proof"},"17824934553683747113":{"error_kind":"string","string":"Invalid nullifier"}}},"bytecode":"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","debug_symbols":"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","file_map":{"50":{"source":"// Ownership circuit: prove control of an existing NFT commitment bound to a metadata hash\n\nuse poseidon::poseidon2::Poseidon2;\n\nfn main(\n    // Private inputs\n    secret: Field,\n    token_id: Field,\n    owner_pub_key: Field,\n    metadata_hash_private: Field,\n    merkle_proof: [Field; 20],\n    leaf_index: Field,\n\n    // Public inputs\n    root: pub Field,\n    nullifier: pub Field,\n    metadata_hash: pub Field,\n) {\n    // Ensure metadata hash matches public value\n    assert(metadata_hash_private == metadata_hash, \"Metadata hash mismatch\");\n\n    // Recompute commitment from private note data\n    let commitment_inputs: [Field; 3] = [secret, token_id, owner_pub_key];\n    let commitment = Poseidon2::hash(commitment_inputs, commitment_inputs.len());\n\n    // Verify commitment is included in the Merkle tree under the provided root\n    let computed_root = compute_merkle_root(commitment, merkle_proof, leaf_index);\n    assert(computed_root == root, \"Invalid Merkle proof\");\n\n    // Recompute nullifier to prevent double spending\n    let nullifier_inputs: [Field; 4] = [secret, token_id, owner_pub_key, 1];\n    let computed_nullifier = Poseidon2::hash(nullifier_inputs, nullifier_inputs.len());\n    assert(computed_nullifier == nullifier, \"Invalid nullifier\");\n}\n\nfn compute_merkle_root(\n    leaf: Field,\n    proof: [Field; 20],\n    index: Field,\n) -> Field {\n    let mut current_hash = leaf;\n    let mut current_index = index;\n\n    for i in 0..20 {\n        let sibling = proof[i];\n        let index_as_u32 = current_index as u32;\n        let is_left = (index_as_u32 % 2) == 0;\n\n        let hash_inputs: [Field; 2] = if is_left {\n            [current_hash, sibling]\n        } else {\n            [sibling, current_hash]\n        };\n\n        current_hash = Poseidon2::hash(hash_inputs, hash_inputs.len());\n        current_index = (index_as_u32 / 2) as Field;\n    }\n\n    current_hash\n}\n","path":"/home/sponge-protocol/sponge-protocol-back/circuits-privacy/ownership/src/main.nr"},"57":{"source":"use std::default::Default;\nuse std::hash::Hasher;\n\ncomptime global RATE: u32 = 3;\n\npub struct Poseidon2 {\n    cache: [Field; 3],\n    state: [Field; 4],\n    cache_size: u32,\n    squeeze_mode: bool, // 0 => absorb, 1 => squeeze\n}\n\nimpl Poseidon2 {\n    #[no_predicates]\n    pub fn hash<let N: u32>(input: [Field; N], message_size: u32) -> Field {\n        Poseidon2::hash_internal(input, message_size, message_size != N)\n    }\n\n    pub(crate) fn new(iv: Field) -> Poseidon2 {\n        let mut result =\n            Poseidon2 { cache: [0; 3], state: [0; 4], cache_size: 0, squeeze_mode: false };\n        result.state[RATE] = iv;\n        result\n    }\n\n    fn perform_duplex(&mut self) {\n        // add the cache into sponge state\n        for i in 0..RATE {\n            // We effectively zero-pad the cache by only adding to the state\n            // cache that is less than the specified `cache_size`\n            if i < self.cache_size {\n                self.state[i] += self.cache[i];\n            }\n        }\n        self.state = crate::poseidon2_permutation(self.state, 4);\n    }\n\n    fn absorb(&mut self, input: Field) {\n        assert(!self.squeeze_mode);\n        if self.cache_size == RATE {\n            // If we're absorbing, and the cache is full, apply the sponge permutation to compress the cache\n            self.perform_duplex();\n            self.cache[0] = input;\n            self.cache_size = 1;\n        } else {\n            // If we're absorbing, and the cache is not full, add the input into the cache\n            self.cache[self.cache_size] = input;\n            self.cache_size += 1;\n        }\n    }\n\n    fn squeeze(&mut self) -> Field {\n        assert(!self.squeeze_mode);\n        // If we're in absorb mode, apply sponge permutation to compress the cache.\n        self.perform_duplex();\n        self.squeeze_mode = true;\n\n        // Pop one item off the top of the permutation and return it.\n        self.state[0]\n    }\n\n    fn hash_internal<let N: u32>(\n        input: [Field; N],\n        in_len: u32,\n        is_variable_length: bool,\n    ) -> Field {\n        let two_pow_64 = 18446744073709551616;\n        let iv: Field = (in_len as Field) * two_pow_64;\n        let mut sponge = Poseidon2::new(iv);\n        for i in 0..input.len() {\n            if i < in_len {\n                sponge.absorb(input[i]);\n            }\n        }\n\n        // In the case where the hash preimage is variable-length, we append `1` to the end of the input, to distinguish\n        // from fixed-length hashes. (the combination of this additional field element + the hash IV ensures\n        // fixed-length and variable-length hashes do not collide)\n        if is_variable_length {\n            sponge.absorb(1);\n        }\n        sponge.squeeze()\n    }\n}\n\npub struct Poseidon2Hasher {\n    _state: [Field],\n}\n\nimpl Hasher for Poseidon2Hasher {\n    fn finish(self) -> Field {\n        let iv: Field = (self._state.len() as Field) * 18446744073709551616; // iv = (self._state.len() << 64)\n        let mut sponge = Poseidon2::new(iv);\n        for i in 0..self._state.len() {\n            sponge.absorb(self._state[i]);\n        }\n        sponge.squeeze()\n    }\n\n    fn write(&mut self, input: Field) {\n        self._state = self._state.push_back(input);\n    }\n}\n\nimpl Default for Poseidon2Hasher {\n    fn default() -> Self {\n        Poseidon2Hasher { _state: &[] }\n    }\n}\n","path":"/root/nargo/github.com/noir-lang/poseidon/v0.1.1/src/poseidon2.nr"}},"names":["main"],"brillig_names":["directive_integer_quotient","directive_invert"]}